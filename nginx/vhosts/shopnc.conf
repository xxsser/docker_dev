server {
    listen 80;
    server_name  shopnc.cc;
	index index.html index.htm index.php;
	root /opt/webroot/shopnc;

	location / {
	    rewrite ^(/shop)?/index.php$ /shop/index.php last;
        rewrite ^(/shop)?/category.html$ /shop/index.php?act=category&op=index last;
        rewrite ^(/shop)?/([0-9]+).html$ /shop/index.php?act=goods&goods_id=$2 last;
        rewrite ^(/shop)?/category.html$ /shop/index.php?act=category&act=index last;
        rewrite ^(/shop)?/shop_view-(/d+)-(\d+)-([0-5])-([0-2])-(\d+).html$ /shop/index.php?act=show_store&op=goods_all&store_id=$2&stc_id=$3&key=3&order=$5&curpage=$6 last;
        rewrite ^(/shop)?/article-([0-9]+).html$ /shop/index.php?act=article&article_id=$2 last;
        rewrite ^(/shop)?/article_cate-([0-9]+).html$ /shop/index.php?act=article&op=article&ac_id=$2 last;
        rewrite ^(/shop)?/document-([a-zA-Z_]+).html$ /shop/index.php?act=document&code=$2 last;
        rewrite ^(/shop)?/cate-(\d+)-([0-9_]+)-([0-9_]+)-([0-3])-([0-2])-([0-1])-([0-1])-(\d+)-(?<n0>\d+).html$ /shop/index.php?act=search&op=index&cate_id=$2&b_id=$3&a_id=$4&key=$5&order=$6&type=$7&gift=$8&area_id=$9&curpage=$n0 last;
        rewrite ^(/shop)?/brand-(\d+)-([0-3])-([0-2])-([0-1])-([0-1])-(\d+)-(\d+).html$ /shop/index.php?act=brand&op=list&brand=$2&key=$3&order=$4&type=$5&gift=$6&area_id=$7&currpage=$8 last;
        rewrite ^(/shop)?/brand.html$ /shop/index.php?act=brand&op=index last;
        rewrite ^(/shop)?/night.html$ /shop/index.php?act=night&op=index last;
        rewrite ^(/shop)?/groupbuy.html$ /shop/index.php?act=show_groupbuy&op=index last;
        rewrite ^(/shop)?/groupbuy_detail-(\d+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_detail&group_id=$2 last;
        rewrite ^(/shop)?/groupbuy_list-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_list&class=$2&s_class=$3&groupbuy_price=$4&groupbuy_order_key=$5&groupbuy_order=$6&curpage=$7 last;
        rewrite ^(/shop)?/groupbuy_soon-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_soon&class=$2&s_class=$3&groupbuy_price=$4&groupbuy_order_key=$5&groupbuy_order=$6&curpage=$7 last;
        rewrite ^(/shop)?/groupbuy_history-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_history&class=$2&s_class=$3&groupbuy_price=$4&groupbuy_order_key=$5&groupbuy_order=$6&curpage=$7 last;
        rewrite ^(/shop)?/vr_groupbuy_list-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=vr_groupbuy_list&vr_class=$2&vr_s_class=$3&vr_area=$4&vr_mall=$5&groupbuy_price=$6&groupbuy_order_key=$7&groupbuy_order=$8&curpage=$9 last;
        rewrite ^(/shop)?/vr_groupbuy_soon-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=vr_groupbuy_soon&vr_class=$2&vr_s_class=$3&vr_area=$4&vr_mall=$5&groupbuy_price=$6&groupbuy_order_key=$7&groupbuy_order=$8&curpage=$9 last;
        rewrite ^(/shop)?/vr_groupbuy_history-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+)-(\d+).html$ /shop/index.php?act=show_groupbuy&op=vr_groupbuy_history&vr_class=$2&vr_s_class=$3&vr_area=$4&vr_mall=$5&groupbuy_price=$6&groupbuy_order_key=$7&groupbuy_order=$8&curpage=$9 last;
        rewrite ^(/shop)?/integral.html$ /shop/index.php?act=pointshop&op=index last;
        rewrite ^(/shop)?/integral_list.html$ /shop/index.php?act=pointshop&op=plist last;
        rewrite ^(/shop)?/integral_item-(\d+).html$ /shop/index.php?act=pointshop&op=pinfo&id=$2 last;
        rewrite ^(/shop)?/voucher.html$ /shop/index.php?act=pointvoucher&op=index last;
        rewrite ^(/shop)?/grade.html$ /shop/index.php?act=pointgrade&op=index last;
        rewrite ^(/shop)?/explog-(\d+).html$ /shop/index.php?act=pointgrade&op=exppointlog&currpage=$2 last;
        rewrite ^(/shop)?/comments-(\d+)-([0-3])-(\d+).html$ /shop/index.php?act=goods&op=comments_list&goods_id=$2&type=$3&currpage=$4 last;
        rewrite ^(/shop)?/goods-([0-9]+)(-?)([0-9]*).html$ /shop/index.php?act=goods&goods_id=$2 last;
        rewrite ^(/shop)?/groupbuy-([0-9]+)-([0-9]+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_detail&group_id=$2&id=$3 last;
        rewrite ^(/shop)?/store-([0-9]+).html$ /shop/index.php?act=show_store&store_id=$2 last;
        rewrite ^(/shop)?/activity-([0-9]+)-([0-9]*).html$ /shop/index.php?act=activity&activity_id=$2&nav_id=$3 last;
        rewrite ^(/shop)?/store_nav-([0-9]+)-([0-9]+).html$ /shop/index.php?act=show_store&store_id=$2&article=$3 last;
        rewrite ^(/shop)?/coupon_info-([0-9]+)-([0-9]+).html$ /shop/index.php?act=coupon_store&op=detail&coupon_id=$2&id=$3 last;
        rewrite ^(/shop)?/-([0-9]+)-([0-9]+).html$ /shop/index.php?act=show_groupbuy&op=groupbuy_detail&group_id=$2&id=$3 last;
        rewrite ^(/shop)?/night-([a-zA-Z_]+).html$ /shop/index.php?act=night&op=night&code=$2 last;
        rewrite ^(/shop)?/shop-(\d+).html$ /shop/index.php?act=show_store&op=index&store_id=$2 last;
	    rewrite ^(/shop)?/item-(\d+).html$ /shop/index.php?act=goods&op=index&goods_id=$2 last;
	    rewrite ^(/shop)?/channel-(\d+).html$ /shop/index.php?act=channel&op=index&id=$2 last;
        rewrite ^(/shop)?/store_snshome-index-sid-(\d+).html$ /shop/index.php?act=store_snshome&op=index&sid=$2 last;
        rewrite ^(/shop)?/promotion.html$ /shop/index.php?act=promotion&op=index last;
        rewrite ^(/shop)?/shop/store_snshome-index-sid-(\d+)-type-(\w+).html$ /shop/index.php?act=store_snshome&op=index&sid=$2&type=$3 last;
    }
    
	location ~ .*\.php?$
	{
		fastcgi_pass  php:9000;
		fastcgi_index index.php;
		include fastcgi.conf;
	}
	location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
	{
		expires 30d;
	}
	location ~ .*\.(js|css)?$
	{
		expires 1h;
	}
}
